/*JOIN*/
/*EMP 테이블 사원번호로 DEPT 테이블의 지역 검색*/
SELECT * FROM EMP;
SELECT * FROM DEPT;

SELECT EMPNO, ENAME, DNAME, LOC FROM DEPT JOIN EMP
ON EMP.DEPTNO = DEPT.DEPTNO;

/*PLAYER 테이블에서 송종국 선수가 속한 팀의 전화번호 검색하기*/
/*PLAYER 테이블의 컬럼 : TEAM_ID*/
/*TEAM 테이블의 컬럼 : TEAM_ID*/
SELECT * FROM PLAYER;
SELECT * FROM TEAM;
SELECT COUNT(TEAM_ID) FROM PLAYER;
SELECT COUNT(TEAM_ID) FROM TEAM;

SELECT * FROM TEAM T JOIN PLAYER P
ON P.TEAM_ID = T.TEAM_ID AND WHERE PLAYER_NAME = '송종국';

--SELECT * FROM TEAM T JOIN PLAYER P
--ON P.TEAM_ID = T.TEAM_ID
--WHERE PLAYER_NAME = '송종국';

/*JOBS 테이블에서 JOB_ID로 직원들의 JOB_TITLE, EMAIL, 성, 이름 검색*/
SELECT * FROM JOBS;
SELECT * FROM EMPLOYEES;

SELECT JOB_TITLE, EMAIL, E.LAST_NAME ||' '|| E.FIRST_NAME AS NAME
FROM JOBS J JOIN EMPLOYEES E
ON J.JOB_ID = E.JOB_ID;

/*EMP 테이블의 SAL를 SALGRADE 등급으로 나누기*/
SELECT * FROM EMP;
SELECT * FROM SALGRADE;

SELECT GRADE, EMPNO, ENAME, SAL FROM SALGRADE S JOIN EMP E
ON E.SAL BETWEEN S.LOSAL AND S.HISAL
ORDER BY GRADE DESC;

/*EMPLOYEES 테이블에서 HIREDATE가 2003~2005년까지인 사원의 정보와 부서명 검색*/
SELECT * FROM EMPLOYEES;
SELECT * FROM DEPARTMENTS;

/*
 * 자동 형변환
 * 
 * DATE타입을 문자열과 비교할 땐 자동 형변환이 가능하다.
 * 대신 문자열 형식은 'YYYY-MM-DD', 'YYYYMMDD'로 작성해야 한다.
 * */
SELECT * FROM DEPARTMENTS D JOIN EMPLOYEES E
ON D.DEPARTMENT_ID  = E.DEPARTMENT_ID
AND HIRE_DATE BETWEEN '20030101' AND '20051231';

/*해당 일자까지 포함*/
SELECT * FROM DEPARTMENTS D JOIN EMPLOYEES E
ON D.DEPARTMENT_ID  = E.DEPARTMENT_ID
AND HIRE_DATE BETWEEN TO_DATE('2003-01-01','YYYY-MM-DD')  AND TO_DATE('2005-12-24','YYYY-MM-DD');

/*해당 월 이전까지 포함*/
SELECT * FROM DEPARTMENTS D JOIN EMPLOYEES E
ON D.DEPARTMENT_ID  = E.DEPARTMENT_ID
AND HIRE_DATE BETWEEN TO_DATE('2003-01','YYYY-MM')  AND TO_DATE('2005-12','YYYY-MM');

/*JOB_TITLE 중 'Manager'라는 문자열이 포함된 직업들의 평균 연봉을 JOB_TITLE별로 검색*/
SELECT * FROM JOBS;
SELECT * FROM EMPLOYEES;

SELECT JOB_TITLE, AVG(SALARY) 평균연봉 FROM JOBS J JOIN EMPLOYEES E
ON J.JOB_ID = E.JOB_ID AND JOB_TITLE LIKE '%Manager%'
GROUP BY JOB_TITLE;

/*EMP 테이블에서 ENAME에 L이 있는 사원들의 DNAME과 LOC 검색*/









