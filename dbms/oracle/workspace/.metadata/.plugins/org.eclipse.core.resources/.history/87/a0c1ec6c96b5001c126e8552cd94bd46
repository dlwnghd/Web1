/*브론즈*/
/*PLAYER 테이블에서 키가 NULL인 선수들은 키를 170으로 변경하여 평균 구하기(NULL 포함)*/
SELECT * FROM PLAYER
WHERE HEIGHT = NULL;

UPDATE PLAYER 
SET HEIGHT = 170
WHERE HEIGHT IS NULL;

SELECT AVG(HEIGHT) FROM PLAYER;

/*실버*/
/*PLAYER 테이블에서 팀 별 최대 몸무게*/
SELECT P.TEAM_ID, MAX(WEIGHT) || 'kg' "최대 몸무게" FROM PLAYER P
GROUP BY TEAM_ID
ORDER BY 1;

/*골드*/
/*AVG 함수를 쓰지 않고 PLAYER 테이블에서 선수들의 평균 키 구하기(NULL 미포함)*/
SELECT SUM(HEIGHT) / COUNT(HEIGHT) AS "평균 키" FROM PLAYER;

/*플래티넘*/
/*DEPT 테이블의 LOC별 평균 급여를 반올림한 값과 각 LOC별 SAL 총 합을 조회*/
SELECT * FROM DEPT;
SELECT * FROM EMP;

SELECT LOC, ROUND(AVG(SAL)) AS "평균 급여 반올림한 값", SUM(SAL) AS "LOC별 SAL 총 합"  FROM (SELECT * FROM EMP E JOIN DEPT D
ON E.DEPTNO = D.DEPTNO)
GROUP BY LOC;

/*다이아*/
/*PLAYER 테이블에서 팀별 최대 몸무게인 선수 출력*/
SELECT P1.TEAM_ID, PLAYER_NAME, HEIGHT, WEIGHT, BIRTH_DATE
FROM
	(
		SELECT TEAM_ID, MAX(WEIGHT) M FROM PLAYER
		GROUP BY TEAM_ID
	) P1 
JOIN PLAYER P2
ON P1.TEAM_ID = P2.TEAM_ID AND P1.M = P2.WEIGHT
ORDER BY 1;

/*마스터*/
/*EMP 테이블에서 HIREDATE가 FORD의 입사년도와 같은 사원 전체 정보 조회*/
SELECT * FROM (SELECT E.EMPNO, E.ENAME, E.JOB, E.MGR, E.HIREDATE, E.SAL, E.COMM, D.DEPTNO, D.DNAME, D.LOC FROM EMP E JOIN DEPT D
ON E.DEPTNO = D.DEPTNO)
WHERE HIREDATE = 
(
	SELECT HIREDATE FROM EMP E2
	WHERE ENAME = 'FORD'
);

-- 부족하다고 느낀 풀이
SELECT * FROM EMP E1
WHERE HIREDATE = 
(
	SELECT HIREDATE FROM EMP E2
	WHERE ENAME = 'FORD'
);


